---
import { Audit } from "dpe-audit";
import { $audit } from "../../stores/user";
import { useFixtures } from "../../fixtures/fixtures";
import { Container, Layout, Main } from "../../components/Layout";
import {
	ConfortEte,
	Consommations,
	InformationLogement,
	PerformanceClimatique,
	PerformanceEnergetique,
	PerformanceEnveloppe,
	PerformanceIsolation,
	RepartitionDeperditions,
} from "../../components/Audit";
import { AuditActions } from "../../components/Actions";

useFixtures();

const audit = $audit.get();

if (null === audit) {
	return Astro.redirect("/mon-audit/recherche");
}
---

<Layout>
	<header class="md:hidden bg-primary sticky z-1 top-0 w-full">
		<AuditActions />

		<div class="pb-3 text-center text-white">
			<p class="font-semibold">
				{Audit.typeBatimentToString(audit.batiment.type)}
			</p>
			<p>{Audit.adresseToString(audit.adresse)}</p>
		</div>
	</header>

	<Container>
		<Main>
			<div
				class="grid gap-6 auto-cols-min grid-cols-1 lg:grid-cols-3 auto-rows-min"
			>
				<div
					class="grid auto-rows-min auto-cols-min grid-cols-1 gap-6 md:grid-cols-2 lg:order-last lg:grid-cols-1"
				>
					<PerformanceEnergetique
						etiquette_energie={audit.data.etiquette_energie}
						cef={audit.data.cef}
						cep={audit.data.cep}
					/>

					<PerformanceClimatique
						etiquette_climat={audit.data.etiquette_climat}
						eges={audit.data.eges}
					/>
					<PerformanceIsolation
						performance={audit.enveloppe.data.performance}
					/>
					<ConfortEte
						confort_ete={audit.enveloppe.data.confort_ete}
					/>
					<RepartitionDeperditions
						deperditions={audit.enveloppe.data.deperditions}
					/>
				</div>
				<div
					class="grid gap-6 auto-rows-min grid-cols-1 lg:order-first lg:col-span-2"
				>
					<InformationLogement
						class="hidden lg:block"
						batiment={audit.batiment}
						adresse={audit.adresse}
					/>

					<Consommations consommations={audit.data.consommations} />

					<PerformanceEnveloppe
						murs={audit.enveloppe.murs}
						planchers_bas={audit.enveloppe.planchers_bas}
						planchers_hauts={audit.enveloppe.planchers_hauts}
						baies={audit.enveloppe.baies}
						portes={audit.enveloppe.portes}
						ponts_thermiques={audit.enveloppe.ponts_thermiques}
					/>
				</div>
			</div>
		</Main>
	</Container>
</Layout>
